---
phase: 04-app-ecosystem
plan: 04
type: execute
wave: 4
depends_on: ["04-01", "04-02", "04-03"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "chezmoi apply completes without errors"
    - "nvim opens with LazyVim working"
    - "CLI tools (bat, fzf, rg, eza) use configured defaults"
    - "lazygit uses delta for diffs"
    - "Package installation script runs on first apply"
  artifacts: []
  key_links: []
---

<objective>
Verify Phase 4 completion by running chezmoi apply and confirming all app and CLI tool configs work correctly

Purpose: End-to-end verification that the entire app ecosystem is properly managed and functional
Output: Verified working configuration + human approval
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/04-app-ecosystem/04-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Run chezmoi diff and apply</name>
  <files></files>
  <action>
Run chezmoi to preview and apply all Phase 4 changes:

1. First, preview all changes:
```bash
chezmoi diff
```

2. Review the diff output - expect to see:
   - New files in `.config/nvim/`, `.config/ghostty/`, `.config/htop/`, `.config/gh/`, `.config/kanata/`
   - New files in `.config/bat/`, `.config/fd/`, `.config/ripgrep/`, `.config/lazygit/` (or Library path on macOS)
   - Updated `.zshrc` with CLI tool section
   - New `.chezmoidata/packages.yaml`
   - New run_onchange scripts in `.chezmoiscripts/`

3. Apply changes:
```bash
chezmoi apply -v
```

4. Note: The package installation script will run on first apply. This may take a few minutes as it installs Homebrew packages (on macOS) or pacman packages (on Arch).

5. After apply completes, verify managed files:
```bash
chezmoi managed | grep -E "(nvim|ghostty|bat|lazygit)"
```
  </action>
  <verify>Run `chezmoi verify` (should return 0 exit code). Run `chezmoi managed | wc -l` to see total managed files count.</verify>
  <done>chezmoi apply completed successfully, all new configs are managed</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete Phase 4 app ecosystem:
- nvim/LazyVim configuration
- ghostty, htop, gh CLI configs
- kanata keyboard remapping (macOS)
- CLI tool configs (bat, fd, ripgrep, lazygit)
- CLI tool env vars (fzf, eza, zoxide)
- Package management infrastructure
  </what-built>
  <how-to-verify>
1. **Open a new terminal** (to reload zshrc)

2. **Verify nvim:**
   ```bash
   nvim --version   # Should show NVIM version
   nvim             # Should open with LazyVim, plugins should install on first run
   ```
   In nvim, type `:Lazy` - should show lazy.nvim plugin manager

3. **Verify CLI tools with new configs:**
   ```bash
   # bat with theme
   bat ~/.zshrc     # Should show syntax highlighting with Catppuccin theme

   # fzf with fd
   fzf              # Ctrl+T should show files (using fd)

   # ripgrep with config
   rg --version     # Then try: rg "export" ~/.zshrc (should work with smart-case)

   # eza with icons
   eza -la          # Should show file icons

   # zoxide echo
   z ~              # Should echo the directory path
   ```

4. **Verify lazygit:**
   ```bash
   cd ~/.dotfiles
   lazygit          # Should open with delta diffs (colored) and icons
   ```
   Press `q` to exit

5. **Verify ghostty config applied** (if using Ghostty terminal):
   - Open Ghostty preferences or check if theme/fonts match your config

6. **Confirm package script ran:**
   ```bash
   # On macOS:
   ls ~/.local/share/chezmoi/.chezmoiscripts/run_onchange_*
   # The darwin script should have run (check brew list for expected packages)
   ```

If any tool doesn't work as expected, note what's wrong.
  </how-to-verify>
  <resume-signal>Type "approved" if everything works, or describe any issues encountered</resume-signal>
</task>

</tasks>

<verification>
1. Human verified nvim opens with LazyVim
2. Human verified CLI tools use configured defaults
3. Human verified lazygit uses delta
4. chezmoi managed shows all expected files
5. No errors during chezmoi apply
</verification>

<success_criteria>
Phase 4 complete when:
- [ ] chezmoi apply runs without errors
- [ ] nvim opens with LazyVim and all customizations
- [ ] ghostty, htop, gh CLI configs are in place
- [ ] kanata config present (macOS only)
- [ ] CLI tools (bat, eza, fd, fzf, rg, lazygit, zoxide) have correct configs
- [ ] Package installation script executed successfully
- [ ] Human approved all functionality
</success_criteria>

<output>
After completion, create `.planning/phases/04-app-ecosystem/04-04-SUMMARY.md`
</output>
